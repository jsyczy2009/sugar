/*!
 * mvvm.js v1.1.2
 * (c) 2016 TANG
 * Released under the MIT license
 * https://github.com/tangbc/sugar
 * Sat Jul 02 2016 10:39:37 GMT+0800 (CST)
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.MVVM=e()}(this,function(){"use strict";function t(t){return"[object Object]"===F.toString.call(t)}function e(t){return Array.isArray(t)}function i(t){return t instanceof Function}function s(t){return"string"==typeof t}function n(t){return"boolean"==typeof t}function a(t){return"number"==typeof t&&!isNaN(t)}function r(e){return e&&t(e)&&!e.nodeType&&e!==e.window?!e.constructor||L.call(e.constructor.prototype,"isPrototypeOf"):!1}function c(t){return 0===Object.keys(t).length}function o(t,e){for(var i,s,n,a=t.$data.$els,r=e.childNodes,c=0;c<r.length;c++)if(i=r[c],t.isElementNode(i)){n=i.attributes;for(var h=0;h<n.length;h++)s=n[h],"v-el"===s.name&&P.hasOwn(a,s.value)&&(a[s.value]=null);i.childNodes.length&&o(t,i)}}function h(t){this.vm=t,this.$listeners={}}function l(t,e,i,s){P.isString(e)&&(e=i[e]),this.$args=s,this.$context=i,this.$callback=e,this.$subPaths=[],this.$action=921,this.$methods="push|pop|shift|unshift|splice|sort|reverse".split("|"),this.observe(t)}function u(t){this.$model=t,this.$modelSubs={},this.$accessSubs={},this.$indexSubs={},this.$deepSubs={},this.observer=new l(t,"change",this)}function p(t){return W.test(t)&&!H.test(t)&&0!==t.indexOf("Math.")}function d(t){var e=Q.length;return Q[e]=t,'"'+e+'"'}function f(t,e){return Q[e]}function v(t){var e=t.charAt(0),i=t.slice(1);return U.test(i)?t:(i=-1!==i.indexOf('"')?i.replace(z,f):i,e+"scope."+i)}function m(t,e){var i,s=e;return-1!==s.indexOf(t.alias)?t.alias:(P.each(t.aliases,function(t){return new RegExp("\\b"+t+"\\b|\\b"+t+"\\.").test(s)?(i=t,!1):void 0}),i)}function g(){}function b(t){var e,i,s=P.removeSpace(t),n=s.match(/(\(.*\))/),a=n&&n[0];return a?(i=s.substr(0,s.indexOf(a)),e="["+a.substr(1,a.length-2)+"]"):i=s,{func:i,args:e}}function y(t){var e,i,s=t.trim(),n=s.length;return/^\{.*\}$/.test(s)&&(e={},s=s.substr(1,n-2).replace(/\s/g,""),i=s.match(/[^,]+:[^:]+((?=,[^:]+:)|$)/g),P.each(i,function(t){var i=P.getKeyValue(t,!0),s=i[0],n=i[1];s&&n&&(s=s.replace(/(^'*)|('*$)|(^"*)|("*$)/g,""),e[s]=n)})),e}function x(t){this.vm=t,this.$listeners={},g.call(this)}function w(t){this.vm=t,g.call(this)}function $(t){this.vm=t,g.call(this)}function S(t){this.vm=t,g.call(this)}function C(t){this.vm=t,g.call(this)}function O(t){this.vm=t,g.call(this)}function A(t){this.vm=t,g.call(this)}function E(t){this.vm=t,g.call(this)}function k(t){this.vm=t,g.call(this)}function N(t){this.vm=t,this.vclass=new E(t),this.vstyle=new k(t),g.call(this)}function _(t,e){return M.hasAttr(t,"number")?+e:e}function j(t){var e,i,s,n=t.options,a=M.hasAttr(t,"number"),r=n.length,c=[];for(e=0;r>e;e++)i=n[e],s=i.value,i.selected&&c.push(a?+s:_(i,s));return c}function R(t){this.vm=t,g.call(this)}function T(t,e){return this.isElementNode(t)?P.isObject(e)?(this.$element=t,this.$fragment=P.nodeToFragment(this.$element),this.$data=e,P.defRec(e,"$els",{}),P.defRec(e,"$scope",{}),this.$unCompileNodes=[],this.$rootComplied=!1,this.updater=new h(this),this.watcher=new u(this.$data),this.von=new x(this),this.vel=new w(this),this.vif=new $(this),this.vfor=new S(this),this.vtext=new C(this),this.vhtml=new O(this),this.vshow=new A(this),this.vbind=new N(this),this.vmodel=new R(this),this.$inputs="input|select|textarea".split("|"),void this.init()):P.warn("model must be a type of Object: ",e):P.warn("element must be a type of DOMElement: ",t)}function D(t,e,i){var s=this.context=i||this;P.each(e,function(t,i){P.isFunc(t)&&(e[i]=t.bind(s))}),this.backup=P.copy(e),this.vm=new T(t,e),this.$=this.vm.$data}var F=Object.prototype,L=F.hasOwnProperty,P={isBool:n,isFunc:i,isArray:e,isEmpty:c,isNumber:a,isObject:t,isString:s};P.warn=function(){console.warn.apply(console,arguments)},P.hasOwn=function(t,e){return t&&L.call(t,e)},P.def=function(t,e,i,s,n,a){return Object.defineProperty(t,e,{value:i,writable:!!s,enumerable:!!n,configurable:!!a})},P.defRec=function(t,e,i){return this.def(t,e,i,!0,!1,!0)},P.each=function(i,n,a){var r,c,o=this;if(i)if(a||(a=this),s(n)&&(n=a[n]),e(i))for(c=0;c<i.length&&(r=n.call(a,i[c],c,i),r!==!1);c++)null===r&&(i.splice(c,1),c--);else if(t(i))for(c in i)if(o.hasOwn(i,c)){if(r=n.call(a,i[c],c,i),r===!1)break;null===r&&delete i[c]}},P.extend=function(){var t,s,a,c,o,h,l=arguments,u=this,p=arguments[0]||{},d=1,f=arguments.length,v=!1;for(n(p)&&(v=p,p=arguments[d]||{},d++),"object"==typeof p||i(p)||(p={}),d===f&&(p=this,d--);f>d;d++)if(null!=(t=l[d]))for(s in t)a=p[s],c=t[s],p!==c&&(v&&c&&(r(c)||(o=e(c)))?(o?(o=!1,h=a&&e(a)?a:[]):h=a&&r(a)?a:{},p[s]=u.extend(v,h,c)):void 0!==c&&(p[s]=c));return p},P.copy=function(i){var s;return e(i)?s=i.slice(0):t(i)&&(s=this.extend(!0,{},i)),s||i},P.removeSpace=function(t){return t.replace(/\s/g,"")},P.getKeyValue=function(t,e){var i=t.split(":");return e?i:i.pop()},P.createElement=function(t){return document.createElement(t)},P.createFragment=function(){return document.createDocumentFragment()},P.nodeToFragment=function(t){for(var e,i=this.createFragment();e=t.firstChild;)i.appendChild(e);return i},P.stringToFragment=function(t){var e,i;return/<[^>]+>/g.test(t)?(e=this.createElement("div"),e.innerHTML=t,i=this.nodeToFragment(e)):(i=this.createFragment(),i.appendChild(document.createTextNode(t))),i},P.getExpAlias=function(t){var e=t.indexOf(".");return-1===e?t:t.substr(0,e)},P.getExpKey=function(t){var e=t.lastIndexOf(".");return-1===e?"":t.substr(e+1)},P.diff=function(t,e){return{n:this.getUnique(t,e),o:this.getUnique(e,t)}},P.getUnique=function(i,s){var n={};return this.each(i,function(i,a){var r,o=s[a];if(t(i))r=this.getUnique(i,o),c(r)||(n[a]=r);else if(e(i)){var h=[];this.each(i,function(e,i){var s;t(e)?(s=this.getUnique(e,o[i]),h.push(s)):-1===o.indexOf(e)&&h.push(e)},this),n[a]=h}else i!==o&&(n[a]=i)},this),n},P.makePaths=function(t){var e,i=this,s=t&&t.split("*");if(!s||s.length<2)return[];for(var n=s.length-1;n>-1;n--)if(i.isNumber(+s[n])){e=n+1;break}return s.slice(0,e)},P.getDeepValue=function(t,e){for(var i=e.slice(0);i.length;)t=t[i.shift()];return t},P.makeScopePaths=function(t){var e=0,i=[];if(t.length%2===0)for(;e<t.length;)e+=2,i.push(t.slice(0,e));return i};var M={empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t},setAttr:function(t,e,i){"boolean"==typeof i?t[e]=i:i!==this.getAttr(t,e)&&t.setAttribute(e,i)},getAttr:function(t,e){return t.getAttribute(e)||""},hasAttr:function(t,e){return t.hasAttribute(e)},removeAttr:function(t,e){t.removeAttribute(e)},addClass:function(t,e){var i,s=t.classList;this.hasClass(t,e)||(s?s.add(e):(i=" "+this.getAttr(t,"class")+" ",-1===i.indexOf(" "+e+" ")&&this.setAttr(t,"class",(i+e).trim())))},removeClass:function(t,e){var i,s,n=t.classList;if(this.hasClass(t,e)){if(n)n.remove(e);else{for(s=" "+e+" ",i=" "+this.getAttr(t,"class")+" ";-1!==i.indexOf(s);)i=i.replace(s," ");this.setAttr(t,"class",i.trim())}t.className||this.removeAttr(t,"class")}},hasClass:function(t,e){var i,s=t.classList;return s?s.contains(e):(i=" "+this.getAttr(t,"class")+" ",-1!==i.indexOf(" "+e+" "))},addEvent:function(t,e,i,s){t.addEventListener(e,i,s)},removeEvent:function(t,e,i,s){t.removeEventListener(e,i,s)}},V=h.prototype;V.updateTextContent=function(t,e){t.textContent=String(e)},V.updateHtmlContent=function(t,e){M.empty(t).appendChild(P.stringToFragment(String(e)))},V.updateDisplay=function(t,e){var i=this.getSibling(t);this.setVisible(t),this.updateStyle(t,"display",e?t._visible_display:"none"),i&&(M.hasAttr(i,"v-else")||"v-else"===i._directive)&&(this.setVisible(i),this.updateStyle(i,"display",e?"none":i._visible_display))},V.setVisible=function(t){var e,i,s;t._visible_display||(e=P.removeSpace(M.getAttr(t,"style")),e&&-1!==e.indexOf("display")&&(i=e.split(";"),P.each(i,function(t){-1!==t.indexOf("display")&&(s=P.getKeyValue(t))})),"none"!==s&&(t._visible_display=s||""))},V.updateRenderContent=function(t,e){var i=this.getSibling(t);this.setRender(t),this.toggleRender.apply(this,arguments),i&&(M.hasAttr(i,"v-else")||"v-else"===i._directive)&&(this.setRender(i),this.toggleRender(i,!e))},V.setRender=function(t){t._render_content||(t._render_content=t.innerHTML),M.empty(t)},V.toggleRender=function(t,e){var i=this.vm,s=P.stringToFragment(t._render_content);e?(i.complieElement(s,!0),t.appendChild(s)):o(i,s)},V.getSibling=function(t){var e=t.nextSibling,i=this.vm.isElementNode;if(e&&i(e))return e;for(;e;)if(e=e.nextSibling,e&&i(e))return e;return null},V.updateAttribute=function(t,e,i){null===i?M.removeAttr.apply(this,arguments):"value"===e?t.value=i:M.setAttr(t,e,i)},V.updateClassName=function(t,e,i,s){s?e===!0?M.addClass(t,s):e===!1&&M.removeClass(t,s):(e&&M.addClass(t,e),i&&M.removeClass(t,i))},V.updateStyle=function(t,e,i){t.style[e]!==i&&(t.style[e]=i)},V.updateEvent=function(t,e,i,s,n){n?M.removeEvent(t,e,i,s):M.addEvent(t,e,i,s)},V.updateTextValue=function(t,e){t.value!==e&&(t.value=e)},V.updateRadioChecked=function(t,e){t.checked=t.value===(P.isNumber(e)?String(e):e)},V.updateCheckboxChecked=function(t,e){var i=t.value;return P.isArray(e)||P.isBool(e)?(M.hasAttr(t,"number")&&(i=+i),void(t.checked=P.isBool(e)?e:-1!==e.indexOf(i))):P.warn("checkbox v-model value must be a type of Boolean or Array!")},V.updateSelectChecked=function(t,e,i){var s,n,a,r=M.hasAttr(t,"number"),c=t.options,o=c.length,h=i||M.hasAttr(t,"multiple");for(s=0;o>s;s++)n=c[s],a=n.value,a=r?+a:M.hasAttr(n,"number")?+a:a,n.selected=h?-1!==e.indexOf(a):e===a};var I=l.prototype;I.observe=function(t,e){return P.isArray(t)&&this.rewriteMethods(t,e),P.each(t,function(i,s){var n=e&&e.slice(0);n?n.push(s):n=[s],this.bindWatch(t,n,i)},this),this},I.bindWatch=function(t,e,i){var s=e.join("*"),n=e[e.length-1],a=Object.getOwnPropertyDescriptor(t,n),r=a.get,c=a.set;Object.defineProperty(t,n,{get:function(){return r?r.call(t):i}.bind(this),set:function(a,o){var h,l,u,p=r?r.call(t):i,d=-1!==this.$methods.indexOf(this.$action);a!==p&&(d||!P.isArray(a)&&!P.isObject(a)||this.observe(a,e),h=this.getSubPath(s),h&&(l=t[n]),c?c.call(t,a,!0):i=a,d||o||(u=h?[h,t[n],l]:[s,a,p],this.trigger.apply(this,u)))}.bind(this)});var o=t[n],h=P.isObject(o);(P.isArray(o)||h)&&this.observe(o,e),h&&-1===this.$subPaths.indexOf(s)&&!P.isNumber(+s.split("*").pop())&&this.$subPaths.push(s)},I.getSubPath=function(t){for(var e=this.$subPaths,i=0;i<e.length;i++)if(0===t.indexOf(e[i]))return e[i]},I.rewriteMethods=function(t,e){var i=Array.prototype,s=Object.create(i),n=e&&e.join("*");P.each(this.$methods,function(t){var a=this,r=i[t];P.defRec(s,t,function(){for(var i,s=arguments,c=arguments.length,o=new Array(c);c--;)o[c]=s[c];return a.$action=t,i=r.apply(this,o),a.$action=921,a.observe(this,e),a.trigger(n,this,t,o),i})},this),P.defRec(s,"$set",function(t,e){return t>=this.length&&(t=this.length),this.splice(t,1,e)[0]}),P.defRec(s,"$remove",function(t){var e=this.indexOf(t);return-1!==e?this.splice(e,1):void 0}),t.__proto__=s},I.trigger=function(t,e,i,s){this.$callback.apply(this.$context,[t,e,i,s||this.$args])};var B=u.prototype;B.change=function(t,e,i,s){var n,a=-1!==t.indexOf("*"),r=a?this.$accessSubs[t]:this.$modelSubs[t];this.trigger(r,t,e,i,s),a&&(n=t.split("*").shift(),this.trigger(this.$deepSubs[n],t,e,i,s))},B.trigger=function(t,e,i,s,n){P.each(t,function(t){t.cb.call(t.ct,e,i,s,n||t.arg)})},B.watch=function(t,e,i,s){var n=t.dep,a=t.acc;P.each(n,function(t,n){var r=a[n];if("$event"!==t)return-1!==t.indexOf("$index")?void this.watchIndex(r,e,i,s):r?void this.watchAccess(r,e,i,s):void this.watchModel(P.getExpAlias(t),e,i,s)},this)},B.watchModel=function(t,e,i,s,n){return P.hasOwn(this.$model,t)?-1!==t.indexOf("*")?P.warn('Model key cannot contain the character "*"!'):(this.addSubs(this.$modelSubs,t,e,i,s),void(n&&this.addSubs(this.$deepSubs,t,e,i,s))):P.warn('The field: "'+t+'" does not exist in model!')},B.watchAccess=function(t,e,i,s){this.addSubs(this.$accessSubs,t,e,i,s)},B.watchIndex=function(t,e,i,s){this.addSubs(this.$indexSubs,t,e,i,s)},B.addSubs=function(t,e,i,s,n){t[e]||(t[e]=[]),t[e].push({cb:i,ct:s,arg:n})},B.removeSubs=function(t){P.each(this.$indexSubs,function(e,i){return 0===i.indexOf(t)?null:void 0}),P.each(this.$accessSubs,function(e,i){return 0===i.indexOf(t)?null:void 0})},B.moveSubs=function(t,e,i){var s=t+"*";this.moveIndex(s,e),this.moveAccess(s,e)},B.moveIndex=function(t,e){var i={},s=this.$indexSubs,n=P.copy(s);P.each(e,function(e,a){var r,c=t+a,o=t+e;i[c]=n[o],e===r&&(s[c]=r)}),P.each(i,function(e,i){var s=+i.substr(t.length);P.each(e,function(t){t.cb.call(t.ct,"$index",s,t.arg)})}),P.extend(s,i),i=n=null},B.moveAccess=function(t,e){var i={},s=this.$accessSubs,n=P.copy(s);P.each(e,function(e,a){var r,c=[],o=[],h=t+a,l=t+e;P.each(s,function(t,i){e===r&&0===i.indexOf(h)?(o.push(r),c.push(i)):0===i.indexOf(l)&&(o.push(i),c.push(i.replace(l,h)))}),P.each(c,function(t,e){var a=o[e];a===r?s[t]=r:i[t]=n[a]})}),P.extend(s,i),i=n=null};var K="Math.parseInt.parseFloat.Date.this.true.false.null.undefined.Infinity.NaN.isNaN.isFinite.decodeURI.decodeURIComponent.encodeURI.encodeURIComponent",U=new RegExp("^("+K.replace(/\./g,"\\b|")+"\\b)"),J="var.const.let.if.else.for.in.continue.switch.case.break.default.function.return.do.while.delete.try.catch.throw.finally.with.import.export.instanceof.yield.await",q=new RegExp("^("+J.replace(/\./g,"\\b|")+"\\b)"),z=/"(\d+)"/g,H=/^(true|false)$/,Z=/[\{,]\s*[\w\$_]+\s*:|('[^']*'|"[^"]*")|typeof /g,G=/[^\w$\.]([A-Za-z_$][\w$]*(\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\])*)/g,W=/^[A-Za-z_$][\w$]*(\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*$/,Q=[],X=g.prototype;X.bind=function(t,e,i){var s=this.getDeps(t,i),n=this.getScope(t,i),a=this.getEval(t,i),r=t&&P.copy(t.maps);this.update(e,a.call(n,n)),this.vm.watcher.watch(s,function(){n=this.updateScope(n,r,s,arguments),this.update(e,a.call(n,n))},this)},X.createGetter=function(t){try{return new Function("scope","return "+t+";")}catch(e){throw"Invalid generated expression: "+t}},X.getEval=function(t,e){var i=this.toScope(e);return q.test(i)?P.warn("Avoid using unallow keyword in expression: "+i):(t&&P.each(t.aliases,function(t){var e=new RegExp("scope."+t,"g");i=i.replace(e,function(t){return"scope.$"+t})}),this.createGetter(i))},X.toScope=function(t){var e=t;return p(e)?"scope."+e:(e=(" "+e).replace(Z,d),e=e.replace(G,v),e=e.replace(z,f))},X.getModel=function(){return this.vm.$data},X.getScope=function(t,e){var i=this.getModel();return t&&(P.defRec(i,"$index",t.index),P.defRec(i,"$scope",t.scopes)),i},X.updateScope=function(t,e,i,s){var n,a,r=0,c={},o=this.getModel(),h=P.copy(i.acc);return h.unshift(s[0]),P.each(h,function(t){var e=P.makePaths(t);e.length>r&&(n=e,r=e.length)}),n&&(a=P.makeScopePaths(n),P.each(a,function(t){var i=t.length;"$index"===s[0]&&(t[i-1]=s[1]);var n=t[i-2],a=+t[i-1],r=P.getDeepValue(o,t)||{};P.defRec(o,"$index",a),c[e[n]]=r}),P.defRec(o,"$scope",P.extend(t.$scope,c))),o},X.getDeps=function(t,e){var i=[],s=[],n=" "+e.replace(Z,d),a=n.match(G);return P.each(a,function(e){var n,a,r,c,o=e.substr(1);t?(n=m(t,e),a=-1!==o.indexOf("$index"),(-1!==o.indexOf(n)||a)&&(r=t.accesses[t.aliases.indexOf(n)])):n=P.getExpAlias(o),a||o===n?c=r||t&&t.access:r&&"$event"!==o&&(c=r+"*"+P.getExpKey(o)),-1===i.indexOf(o)&&(i.push(o),s.push(c))}),{dep:i,acc:s}};var Y=x.prototype=Object.create(g.prototype);Y.parse=function(t,e,i,s){-1!==s.indexOf(":")?this.parseSingle.apply(this,arguments):this.parseJson.apply(this,arguments)},Y.parseSingle=function(t,e,i,s){var n=b(i),a=P.getKeyValue(s),r=n.func,c=n.args,o=this.getDeps(t,r),h=this.getScope(t,r),l=this.getEval(t,r),u=l.call(h,h);this.bindEvent(t,e,r,a,u,c),this.vm.watcher.watch(o,function(i,s,n){this.update(e,a,this.$listeners[i],!1,!0),this.bindEvent(t,e,i,a,s,c)},this)},Y.parseJson=function(t,e,i){P.each(y(i),function(i,s){this.parseSingle(t,e,i,s)},this)},Y.bindEvent=function(t,e,i,s,n,a){var r,c,o,h,l,u=this.$listeners,p=t&&t.access||i,d=!1;if(P.isFunc(n)){-1!==s.indexOf(".")&&(r=s.split("."),s=r.shift(),c=r&&-1!==r.indexOf("self"),o=r&&-1!==r.indexOf("stop"),h=r&&-1!==r.indexOf("prevent"),d=r&&-1!==r.indexOf("capture"),l=0===s.indexOf("key")?+r[0]:null);var f,v,m,g,b=[];a&&(f=this.getDeps(t,a),v=t&&P.copy(t.maps),m=this.getScope(t,a),P.defRec(m,"$event","$event"),g=this.getEval(t,a),b=g.call(m,m),this.vm.watcher.watch(f,function(){m=this.updateScope(m,v,f,arguments),b=g.call(m,m)},this));var y=function(t){c&&t.target!==e||l&&l!==t.keyCode||(b.length?P.each(b,function(e,i){("$event"===e||e instanceof Event)&&(b[i]=t)}):b.push(t),o&&t.stopPropagation(),h&&t.preventDefault(),n.apply(this,b))};u[p]=y,this.update(e,s,y,d)}},Y.update=function(){var t=this.vm.updater;t.updateEvent.apply(t,arguments)};var tt=w.prototype=Object.create(g.prototype);tt.parse=function(t,e,i){var s,n,a;if(t){if(n=P.getExpAlias(i),n!==t.alias)return P.warn("when v-el use in v-for must be defined inside current loop body!");a=t.scopes[n],P.isObject(a)&&(s=P.getExpKey(i),a[s]=e)}else this.vm.$data.$els[i]=e};var et=$.prototype=Object.create(g.prototype);et.parse=function(){this.bind.apply(this,arguments)},et.update=function(){var t=this.vm.updater;t.updateRenderContent.apply(t,arguments)};var it=S.prototype=Object.create(g.prototype);it.parse=function(t,e,i){var s,n,a,r=this.vm,c=i.match(/(.*) in (.*)/),o=c[1],h=c[2],l=r.watcher,u=e.parentNode,p="OPTION"===e.tagName&&"SELECT"===u.tagName,d=this.getScope(t,h),f=this.getEval(t,h),v=f.call(d,d),m=h,g=P.getExpKey(h),b=-1,y={},x={},w=[],$=[];return t&&(x=t.maps,b=t.level,y=t.scopes,w=t.aliases.slice(0),$=t.accesses.slice(0),m=t.access+"*"+g),P.isArray(v)?(s=[e,v,0,m,o,w,$,y,x,++b],n=this.buildList.apply(this,s),e.parentNode.replaceChild(n,e),p&&this.updateOption(u,t),a={alias:o,aliases:w,access:m,accesses:$,scopes:y,level:b,maps:x},void(t?l.watchAccess(m,function(t,i,s,n){this.update(u,e,i,s,a,n)},this):l.watchModel(m,function(t,i,s,n){this.update(u,e,i,s,a,n)},this))):void u.removeChild(e)},it.updateOption=function(t,e){var i=t._vmodel,s=this.getEval(e,i),n=this.getScope(e,i),a=s.call(n,n);this.vm.updater.updateSelectChecked(t,a)},it.buildList=function(t,e,i,s,n,a,r,c,o,h){var l=this.vm,u=P.createFragment();return P.each(e,function(e,p){var d,f=i+p,v=s.split("*").pop(),m=t.cloneNode(!0),g=s+"*"+f;c[n]=e,a[h]=n,r[h]=g,o[v]=n,d={alias:n,aliases:a,access:g,accesses:r,scopes:c,maps:o,level:h,index:f},t._vfor_directives>1&&l.blockCompile(t),this.signAlias(m,n),l.complieElement(m,!0,d),u.appendChild(m)},this),u},it.signAlias=function(t,e){P.def(t,"_vfor_alias",e)},it.update=function(t,e,i,s,n,a){switch(s){case"push":this.push.apply(this,arguments);break;case"pop":this.pop.apply(this,arguments);break;case"unshift":this.unshift.apply(this,arguments);break;case"shift":this.shift.apply(this,arguments);break;case"splice":this.splice.apply(this,arguments);break;default:this.recompile.apply(this,arguments)}},it.updateScopes=function(t){var e,i=t.maps,s=t.scopes,n=t.accesses,a=n.length,r=this.vm.$data;return a>1&&(e=P.makePaths(n[a-1]),P.each(P.makeScopePaths(e),function(t){var e=t.length-2,n=i[t[e]],a=P.getDeepValue(r,t)||{};s[n]=a})),s},it.getChanges=function(t,e){var i,s,n={};switch(t){case"unshift":for(n[0]=s,i=1;e>i;i++)n[i]=i-1;break;case"shift":for(i=0;e+1>i;i++)n[i]=i+1;n[e]=s}return n},it.push=function(t,e,i,s,n){var a=i.length-1,r=n.alias,c=[i[a]],o=this.updateScopes(n),h=[e,c,a,n.access,r,n.aliases,n.accesses,o,n.maps,n.level],l=this.getLast(t,r),u=this.buildList.apply(this,h);l?t.insertBefore(u,l.nextSibling):t.appendChild(u)},it.pop=function(t,e,i,s,n){var a=this.getLast(t,n.alias);a&&t.removeChild(a)},it.unshift=function(t,e,i,s,n){var a,r,c,o=n.alias,h=[i[0]],l=this.updateScopes(n),u=[e,h,0,n.access,o,n.aliases,n.accesses,l,n.maps,n.level];a=this.getChanges(s,i.length),this.vm.watcher.moveSubs(n.access,a),r=this.buildList.apply(this,u),c=this.getFirst(t,o),t.insertBefore(r,c)},it.shift=function(t,e,i,s,n){var a=this.getChanges(s,i.length),r=this.getFirst(t,n.alias);r&&(t.removeChild(r),this.vm.watcher.moveSubs(n.access,a))},it.splice=function(t,e,i,s,n,a){var r=a.shift(),c=a.shift(),o=a,h=a.length;if(0!==c||h){var l,u,p,d,f,v,m={},g=n.alias,b=i.length,y=c&&!h,x=!c&&h,w=c&&h;if(y){for(l=0;b>l;l++)m[l]=l>=r?l+c:l;if(P.isEmpty(m))return void this.recompile.apply(this,arguments);this.vm.watcher.moveSubs(n.access,m),this.removeEl(t,g,r,c)}else if(x||w){for(l=0;b>l;l++)x?m[l]=r>l?l:l>=r&&r+h>l?f:l-h:w&&(m[l]=r>l?l:l>=r&&r+h>l?f:l-(h-c));if(P.isEmpty(m)||0===r&&c>b)return void this.recompile.apply(this,arguments);this.vm.watcher.moveSubs(n.access,m),w&&this.removeEl(t,g,r,c),p=this.getChild(t,g,r),v=this.updateScopes(n),d=[e,o,r,n.access,g,n.aliases,n.accesses,v,n.maps,n.level],u=this.buildList.apply(this,d),t.insertBefore(u,p)}}},it.getFirst=function(t,e){var i,s,n=null,a=t.childNodes;for(i=0;i<a.length;i++)if(s=a[i],s._vfor_alias===e){n=s;break}return n},it.getLast=function(t,e){var i,s,n=null,a=t.childNodes;for(i=a.length-1;i>-1;i--)if(s=a[i],s._vfor_alias===e){n=s;break}return n},it.getChild=function(t,e,i){var s,n,a=0,r=null,c=t.childNodes;for(s=0;s<c.length;s++)if(n=c[s],n._vfor_alias===e){if(a===i){r=n;break}a++}return r},it.removeEl=function(t,e,i,s){var n,a,r=t.childNodes,c=-1,o=[];for(n=0;n<r.length;n++)a=r[n],a._vfor_alias===e&&c++,c>=i&&i+s>c&&o.push(a);P.each(o,function(e){return t.removeChild(e),null})},it.recompile=function(t,e,i,s,n){var a,r,c,o=n.alias,h=t.childNodes,l=this.updateScopes(n),u=[e,i,0,n.access,o,n.aliases,n.accesses,l,n.maps,n.level];this.vm.watcher.removeSubs(n.access),c=this.buildList.apply(this,u);for(var p=0;p<h.length;p++)a=h[p],a._vfor_alias===o&&(r?(p--,t.removeChild(a)):r=a);r?t.replaceChild(c,r):t.appendChild(c)};var st=C.prototype=Object.create(g.prototype);st.parse=function(){this.bind.apply(this,arguments)},st.update=function(){var t=this.vm.updater;t.updateTextContent.apply(t,arguments)};var nt=O.prototype=Object.create(g.prototype);nt.parse=function(t,e,i){this.bind.apply(this,[t,this.vm.isTextNode(e)?e.parentNode:e,i])},nt.update=function(){var t=this.vm.updater;t.updateHtmlContent.apply(t,arguments)};var at=A.prototype=Object.create(g.prototype);at.parse=function(){this.bind.apply(this,arguments)},at.update=function(){var t=this.vm.updater;t.updateDisplay.apply(t,arguments)};var rt=E.prototype=Object.create(g.prototype);rt.parse=function(t,e,i){var s=this.getDeps(t,i),n=this.getScope(t,i),a=this.getEval(t,i),r=t&&P.copy(t.maps),c=a.call(n,n);this.updateClass(e,c),this.vm.watcher.watch(s,function(t,i,o){n=this.updateScope(n,r,s,arguments),P.isArray(c)&&(c=[o]),this.updateClass(e,c,!0),c=a.call(n,n),this.updateClass(e,c)},this)},rt.updateClass=function(t,e,i){P.isString(e)?this.update(t,i?null:e,i?e:null):P.isArray(e)?P.each(e,function(e){this.update(t,i?null:e,i?e:null)},this):P.isObject(e)&&P.each(e,function(e,s){this.update(t,i?!1:e,!1,s)},this)},rt.update=function(){var t=this.vm.updater;t.updateClassName.apply(t,arguments)};var ct=k.prototype=Object.create(g.prototype);ct.parse=function(t,e,i){var s=this.getDeps(t,i),n=this.getScope(t,i),a=this.getEval(t,i),r=t&&P.copy(t.maps),c=a.call(n,n);this.updateStyle(e,c),this.vm.watcher.watch(s,function(t,i,c){P.isObject(c)?(P.each(c,function(t,e){c[e]=null}),this.updateStyle(e,P.extend(i,c))):(n=this.updateScope(n,r,s,arguments),this.updateStyle(e,a.call(n,n)))},this)},ct.updateStyle=function(t,e,i){return P.isObject(e)?void P.each(e,function(e,s){this.update(t,s,i?null:e)},this):P.warn("v-bind for style must be a type of Object!",e)},ct.update=function(){var t=this.vm.updater;t.updateStyle.apply(t,arguments)};var ot=N.prototype=Object.create(g.prototype);ot.parse=function(t,e,i,s){var n,a=this.vclass,r=this.vstyle;if(-1!==s.indexOf(":"))switch(n=P.getKeyValue(s)){case"class":a.parse.apply(a,arguments);break;case"style":r.parse.apply(r,arguments);break;default:this.parseAttr(t,e,i,n)}else this.parseJson.apply(this,arguments)},ot.parseJson=function(t,e,i){var s=this.getDeps(t,i),n=this.getScope(t,i),a=this.getEval(t,i),r=P.copy(a.call(n,n)),c=t&&P.copy(t.maps);this.updateJson(e,r),this.vm.watcher.watch(s,function(t,i,o){var h,l;n=this.updateScope(n,c,s,arguments),l=a.call(n,n),h=P.diff(l,r),this.updateJson(e,h.o,!0),this.updateJson(e,h.n),r=P.copy(l)},this)},ot.updateJson=function(t,e,i){var s=this.vclass,n=this.vstyle;P.each(e,function(e,a){switch(a){case"class":s.updateClass(t,e,i);break;case"style":n.updateStyle(t,e,i);break;default:this.update(t,a,e)}},this)},ot.parseAttr=function(t,e,i,s){var n=this.getDeps(t,i),a=this.getScope(t,i),r=this.getEval(t,i),c=t&&P.copy(t.maps);this.update(e,s,r.call(a,a)),this.vm.watcher.watch(n,function(){a=this.updateScope(a,c,n,arguments),this.update(e,s,r.call(a,a))},this)},ot.update=function(){var t=this.vm.updater;t.updateAttribute.apply(t,arguments)};var ht=R.prototype=Object.create(g.prototype);ht.parse=function(t,e,i){var s=this.vm,n=s.$inputs,a=e.tagName.toLowerCase(),r="input"===a?M.getAttr(e,"type"):a;if(-1===n.indexOf(a))return P.warn("v-model only for using in "+n.join(", "));P.def(e,"_vmodel",i);var c=this.getDeps(t,i),o=this.getScope(t,i),h=this.getEval(t,i),l=P.makePaths(c.acc[0]||c.dep[0]),u=P.getDeepValue(this.vm.$data,l),p=h.call(o,o),d=P.getExpKey(i)||i,f=[e,p,c,u,d];switch(r){case"text":case"password":case"textarea":this.parseText.apply(this,f);break;case"radio":this.parseRadio.apply(this,f);break;case"checkbox":this.parseCheckbox.apply(this,f);break;case"select":this.parseSelect.apply(this,f)}},ht.parseText=function(t,e,i,s,n){var a=this.vm,r=a.updater;r.updateTextValue(t,e),a.watcher.watch(i,function(e,i){r.updateTextValue(t,i)},this),this.bindTextEvent(t,s,n)},ht.bindTextEvent=function(t,e,i){var s;M.addEvent(t,"compositionstart",function(){s=!0}),M.addEvent(t,"compositionend",function(){s=!1}),M.addEvent(t,"input",function(){s||(e[i]=this.value)}),M.addEvent(t,"change",function(){e[i]=this.value})},ht.parseRadio=function(t,e,i,s,n){var a=this.vm,r=a.updater;M.hasAttr(t,"checked")&&(s[n]=e=_(t,t.value)),r.updateRadioChecked(t,e),a.watcher.watch(i,function(e,i){r.updateRadioChecked(t,i)},this),this.bindRadioEvent(t,s,n)},ht.bindRadioEvent=function(t,e,i){M.addEvent(t,"change",function(){e[i]=_(this,this.value)})},ht.parseCheckbox=function(t,e,i,s,n){var a=this.vm,r=a.updater;M.hasAttr(t,"checked")&&(P.isBool(e)?s[n]=e=!0:P.isArray(e)&&e.push(_(t,t.value))),r.updateCheckboxChecked(t,e),a.watcher.watch(i,function(e,i){r.updateCheckboxChecked(t,i)},this),this.bindCheckboxEvent(t,s,n,e)},ht.bindCheckboxEvent=function(t,e,i,s){M.addEvent(t,"change",function(){var t,n=this.checked,a=_(this,this.value);P.isBool(s)?e[i]=n:P.isArray(s)&&(t=s.indexOf(a),n?-1===t&&s.push(a):-1!==t&&s.splice(t,1))})},ht.parseSelect=function(t,e,i,s,n){var a,r,c=this.vm.updater,o=M.hasAttr(t,"multiple");if(P.isString(e)){if(o)return P.warn("<select> cannot be multiple when the model set '"+n+"' as not Array!");a=Boolean(e)}else{if(!P.isArray(e))return P.warn("the model "+n+" use in <select> must be a type of String or Array!");if(!o)return P.warn("the model '"+n+"' cannot set as Array when <select> has no multiple propperty!");a=e.length>0}a?c.updateSelectChecked(t,e,o):(r=j(t),s[n]=o?r:r[0]),this.vm.watcher.watch(i,function(e,i){c.updateSelectChecked(t,i,o)}),this.bindSelectEvent(t,s,n,o)},ht.bindSelectEvent=function(t,e,i,s){M.addEvent(t,"change",function(){var t=j(this);e[i]=s?t:t[0]})};var lt=T.prototype;lt.init=function(){this.complieElement(this.$fragment,!0)},lt.complieElement=function(t,e,i){var s,n=this,a=t.childNodes;e&&this.hasDirective(t)&&this.$unCompileNodes.push([t,i]);for(var r=0;r<a.length;r++)s=a[r],n.hasDirective(s)&&n.$unCompileNodes.push([s,i]),s.childNodes.length&&!n.isLateCompile(s)&&n.complieElement(s,!1,i);e&&this.compileAll()},lt.hasDirective=function(t){var e,i=this,s=t.textContent,n=/(\{\{.*\}\})|(\{\{\{.*\}\}\})/;if(this.isElementNode(t)){e=t.attributes;for(var a=0;a<e.length;a++)if(i.isDirective(e[a].name))return!0}else if(this.isTextNode(t)&&n.test(s))return!0},lt.compileAll=function(){P.each(this.$unCompileNodes,function(t){return this.complieDirectives(t),null},this),this.checkCompleted()},lt.complieDirectives=function(t){var e,i,s,n,a=this,r=t[0],c=t[1],o=[];if(this.isElementNode(r)){n=r.attributes;for(var h=0;h<n.length;h++)e=n[h],i=e.name,a.isDirective(i)&&("v-for"===i&&(s=e),o.push(e));s&&(P.def(r,"_vfor_directives",o.length),o=[s],s=null),P.each(o,function(t){this.compile(r,t,c)},this)}else this.isTextNode(r)&&this.compileText(r,c)},lt.compile=function(t,e,i){var s=e.name,n=e.value,a=[i,t,n,s];if(M.removeAttr(t,s),0===s.indexOf("v-bind"))this.vbind.parse.apply(this.vbind,a);else if(0===s.indexOf("v-on"))this.von.parse.apply(this.von,a);else switch(s){case"v-el":this.vel.parse.apply(this.vel,a);break;case"v-text":this.vtext.parse.apply(this.vtext,a);break;case"v-html":this.vhtml.parse.apply(this.vhtml,a);break;case"v-show":this.vshow.parse.apply(this.vshow,a);break;case"v-if":this.vif.parse.apply(this.vif,a);break;case"v-else":P.def(t,"_directive","v-else");break;case"v-model":this.vmodel.parse.apply(this.vmodel,a);break;case"v-for":this.vfor.parse.apply(this.vfor,a);break;case"v-pre":break;default:P.warn(s+" is an unknown directive!")}},lt.compileText=function(t,e){var i,s,n,a,r=[],c=t.textContent.trim().replace(/\n/g,""),o=/\{\{(.+?)\}\}/g,h=/\{\{\{(.+?)\}\}\}/g,l=o.test(c),u=h.test(c);if(u){if(n=c.match(h),s=n[0],i=s.replace(/\s\{|\{|\{|\}|\}|\}/g,""),s.length!==c.length)return P.warn("'"+c+"' compile for HTML can not have a prefix or suffix!");this.vhtml.parse.call(this.vhtml,e,t,i)}else l&&(a=c.split(o),n=c.match(o),P.each(a,function(t){-1!==n.indexOf("{{"+t+"}}")?r.push("("+t+")"):t&&r.push('"'+t+'"')}),this.vtext.parse.call(this.vtext,e,t,r.join("+")))},lt.blockCompile=function(t){P.each(this.$unCompileNodes,function(e){return t===e[0]?null:void 0})},lt.isElementNode=function(t){return 1===t.nodeType},lt.isTextNode=function(t){return 3===t.nodeType},lt.isDirective=function(t){return 0===t.indexOf("v-")},lt.isLateCompile=function(t){return M.hasAttr(t,"v-if")||M.hasAttr(t,"v-for")||M.hasAttr(t,"v-pre")},lt.checkCompleted=function(){0!==this.$unCompileNodes.length||this.$rootComplied||this.rootCompleted()},lt.rootCompleted=function(){this.$rootComplied=!0,this.$element.appendChild(this.$fragment)};var ut=D.prototype;return ut.get=function(t){return P.isString(t)?this.$[t]:this.$},ut.getItem=function(t){return P.copy(this.get(t))},ut.set=function(t,e){var i=this.$;P.isString(t)&&(i[t]=e),P.isObject(t)&&P.each(t,function(t,e){i[e]=t})},ut.reset=function(t){var e=this.$,i=this.backup;P.isString(t)?e[t]=i[t]:P.isArray(t)?P.each(t,function(t){e[t]=i[t]}):P.each(e,function(t,s){e[s]=i[s]})},ut.watch=function(t,e,i){this.vm.watcher.watchModel(t,function(t,i,s){e.call(this,t,i,s)},this.context,null,i)},D});